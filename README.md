# eBExVar (ensemble Bayesian Excess Variance)

## Bayesian Estimation of the ensemble Normlaised Excess Variance for Poisson Data

This project provides code (python script ebexvar.py) to determine the ensemble normalised excess variance of 
a population of Active Galactic Nuclei (AGN) for which multiepoch (X-ray) light curves of Poisson photon counts 
are available. The calculation follows the Bayesian methodology described in Georgakakis et al. (2025, in prep.). 

The sampling of the likelihood uses the python wrapper of the Stan platform (https://mc-stan.org/) 
for statistical modeling and high-performance statistical computation. Installation of the Stan 
python wrapper (https://mc-stan.org/cmdstanpy/) is required to run the code. 

The sample code can be run as
```
python ebexvar.py
```

It reads and compiles the stan model in 

```
STANMODELS/eBExVar.stan
```

and the mock X-ray photon-count light curves in 

 ```
DATA/mock_lcs.fits
```

to infer the ensemble normalised excess variance of the population.

The mock light curve catalogue (DATA/mock_lcs.fits) inlcudes 5-epochs per object for a total of 100 mock AGN. The photon counts (column "counts"), exposure time (column "time") and background (column "bkg") of each epoch are estimated using the typical signal-to-noise ratio of the [eROSITA All Sky Survey Data Release 1 (eRASS1)](https://erosita.mpe.mpg.de/dr1/). Exposure times and background values are randomly drawn from the eRASS1 source catalogue and are assigned to the mock AGN. All mock sources are assumed to have a mean flux of 1.6x10<sup>-13</sup>. Variations around the mean flux are added using red-noise light curves generated by the code presented by [Sartori et al. (2018](https://ui.adsabs.harvard.edu/abs/2018MNRAS.476L..34S), [2019)](https://ui.adsabs.harvard.edu/abs/2019ApJ...883..139S) based on the methods of [Emmanoulopoulos et al. (2013)](http://dx.doi.org/10.1111/j.1745-3933.2011.01106.x).